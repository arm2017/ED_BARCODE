<!DOCTYPE html>
<html>
<head>
<title>ED Barcode</title>
<meta charset='utf-8'>
<!-- jQuery -->
<script src="../js/jquery-1.11.2.js"></script>
<script src="../js/jquery.numeric.js"></script>

<!-- alertMsg -->
<script src="../js/alertMsg.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="../bootstrap-3.3.4/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet"
	href="../bootstrap-3.3.4/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="../bootstrap-3.3.4/js/bootstrap.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript">
	// 	init
	$(document).ready(
			function() {
				var currentStep = localStorage["step"];
				console.log("stay step : " + currentStep);
				//step2
				if (currentStep == "2") {

					var billType = localStorage["billType"];
					if (billType != undefined && billType != '') {
						var $radios = $('input:radio[name=billType]');
						$radios.filter("[value=" + billType + "]").prop(
								'checked', true);
					}
				}

				//set current step 3
				if (currentStep == "3") {
					$("#step2").addClass("hidden");
					$("#step2_1").addClass("hidden");
					$("#step3").removeClass("hidden");
					$("#panelBillType").addClass("hidden");
					$("#senForm").removeClass("hidden");
				}

			});
	// step2
	function validatestep2() {
		console.log("validatestep2 > 3");
		var billType = $("input:checked").val();
		localStorage["step"] = 3;
		localStorage["billType"] = billType;
		// step3
		$("#step2").addClass("hidden");
		$("#step2_1").addClass("hidden");
		$("#step3").removeClass("hidden");
		$("#panelBillType").addClass("hidden");
		$("#senForm").removeClass("hidden");
	}

	function validatestep2_back() {
		console.log("validatestep2_back");
		window.location = "index.html";
	}

	function validatestep3_back() {
		console.log("validatestep3_back");
		localStorage["step"] = 2;
		$("#step2").removeClass("hidden");
		$("#step2_1").removeClass("hidden");
		$("#step3").addClass("hidden");
		$("#panelBillType").removeClass("hidden");
		$("#senForm").addClass("hidden");
	}

	function validatestep3(onlineflag) {
		console.log("validatestep3 > 4");
		console.log("onlineflag : " + onlineflag);
		localStorage["step"] = 4;
		localStorage["onlineflag"] = onlineflag;
		window.location = "step4print.html";

	}
	
	$(function(){
		
		console.log("install Number.prototype.format");
		Number.prototype.format = function(n, x, s, c) {
		    var re = '\\d(?=(\\d{' + (x || 3) + '})+' + (n > 0 ? '\\D' : '$') + ')',
		        num = this.toFixed(Math.max(0, ~~n));

		    return (c ? num.replace('.', c) : num).replace(new RegExp(re, 'g'), '$&' + (s || ','));
		};

			//show sum tax
			var mgjson = localStorage["MainGrid"] ;
			var mgobj = JSON.parse( mgjson );
			
			var rs =  mgobj;
			var sum13 = 0;
			var sum14 = 0;
			for( var index in rs ){
				var r = rs[index].row;
				sum13 += r[13];
				sum14 += r[14];
			}
			
			
			console.log( "sum13 =" +  sum13);
			console.log( "sum14 =" +  sum14);
			$("#col6_1").html(sum13.format(4) );
			$("#col6_2").html(sum14.format(4) );
			
			var sumall  =  sum13+ sum14;
			$("#col7").html(sumall.format(4) );
			
			var col8 = 0;
			$("#col8").html(col8.format(4) );
			
			var col9 = 0;
			$("#col9").html(col9.format(4) );

			var col10 = sumall - col8 - col9;
			$("#col10").html(col10.format(4) );
			
			var royaltax = 10;
			$("#royaltax").val(royaltax);
			var col11 = col10 * 10 / 100;
			$("#col11").html(col11.format(4) );

			var col12 = col10 + col11;
			$("#col12").html(col12.format(4) );

			var col13 = 0;
			$("#col13").html(col13.format(4) );
			
			var col14 = col12 + col13;
			$("#col14").html(col14.format(4) );
			
			
	});
	
</script>

<style type="text/css">

div[id^='col'] {
	width: 100%;
	text-align: right;
}

</style>
</head>
<body>
	<div class="container-fluid">
		<!-- header -->
		<div class="panel panel-default">
			<div class="panel-body" align="center">
				<img src="../resoures/step2.png" alt="step2" id="step2"> <img
					id="step3" src="../resoures/step3.png" alt="step3" class="hidden">
			</div>
		</div>

		<!-- header -->
		<!-- 		sum -->

		<div class="panel panel-primary " id="step2_1">
			<div class="panel-heading">
				<h3 class="panel-title">ยกมา</h3>
			</div>
			<div class="panel-body">
				<div align="center">
					<table class="table" style="width: 100%;">
						<tr>
							<td>(๖.๑) รวมภาษีตามมูลค่า</td>
							<td>
								<div id="col6_1"></div>
							</td>
							<td>บาท</td>
						</tr>
						<tr>
							<td>(๖.๒) รวมภาษีตามปริมาณ</td>
							<td><div id="col6_2"></div></td>
							<td>บาท</td>
						</tr>
						<tr>
							<td>(๗) รวมภาษีสุรา (๖.๑)+(๖.๒)</td>
							<td><div id="col7"></div></td>
							<td>บาท</td>
						</tr>
						<tr>
							<td>
								<table>
									<tr>
										<td>(๘) หัก ค่าภาษีสุรา</td>
										<td><input type="text" class="form-control"
											placeholder="จำนวน"></td>
									</tr>
								</table>
								<table border="0" style="width: 300px; margin-top: 5px;">
									<tr>
										<td>ที่ชำระไว้แล้วจาก</td>
										<td><input type="text" class="form-control"
											placeholder="เลขที่ใบเสร็จ"></td>
									</tr>
								</table>
							</td>
							<td style="vertical-align: bottom;"><div id="col8">0</div></td>
							<td style="vertical-align: bottom;">บาท</td>
						</tr>
						<tr>
							<td>

								<table>
									<tr>
										<td>(๙) หัก คืนภาษี สุราตามหนังสือกรมฯ ที่</td>
										<td><input type="text" class="form-control"
											placeholder=""></td>
									</tr>
								</table>

							</td>
							<td><div id="col9"></div></td>
							<td>บาท</td>
						</tr>
						<tr>
							<td>(๑๐) คงเหลือภาษีสุรา</td>
							<td><div id="col10"></div></td>
							<td>บาท</td>
						</tr>
						<tr>
							<td>
								<table>
									<tr>
										<td>(๑๑) ภาษี เก็บเพิ่มเพื่อกระทรวงมหาดไทยร้อยละ</td>
										<td><input type="text" class="form-control" id="royaltax"
											placeholder=""></td>
									</tr>
								</table>

							</td>
							<td><div id="col11"></div></td>
							<td>บาท</td>
						</tr>
						<tr>
							<td>(๑๒) รวมภาษีที่ต้องชำระ (๑๐) + (๑๑)</td>
							<td><div id="col12"></div></td>
							<td>บาท</td>
						</tr>
						<tr>
							<td>(๑๓) อื่นๆ</td>
							<td><div id="col13"></div></td>
							<td>บาท</td>
						</tr>
						<tr>
							<td>(๑๔) รวม (๑๒) + (๑๓)</td>
							<td><div id="col14"></div></td>
							<td>บาท</td>
						</tr>
					</table>
				</div>
			</div>
		</div>


		<!-- หนังสือสั่งจ่าย -->
		<div class="panel panel-primary" id="panelBillType">
			<div class="panel-heading">16</div>
			<div class="panel-body">
				<label>ออกหนังสือสั่งจ่าย</label>
				<div class="radio">
					<label> <input type="radio" name="billType"
						class="billType" id="optionsRadios1" value="1" checked>
						แสตมป์สุรา
					</label>
				</div>
				<div class="radio">
					<label> <input type="radio" name="billType"
						class="billType" id="optionsRadios2" value="2"> น้ำสุรา
					</label>
				</div>
				<div class="radio">
					<label> <input type="radio" name="billType"
						class="billType" id="optionsRadios3" value="3">
						เครื่องหมายแสดงการเสียภาษีสุรา
					</label>
				</div>

			</div>
			<div class="panel-footer" align="center">
				<button type="button" class="btn btn-default"
					onclick="validatestep2_back();">ย้อนกลับ</button>
				&nbsp;
				<button type="button" class="btn btn-primary"
					onclick="validatestep2()">ถัดไป</button>
			</div>
		</div>

		<!-- เลือกทำรายการ		 -->
		<div class="panel panel-primary hidden" id="senForm">
			<div class="panel-heading">ส่งแบบฟอร์ม สร.120-11</div>
			<div class="panel-body">


				<div align="center">
					<button type="button" class="btn btn-default"
						onclick="validatestep3(false);">ออฟไลน์</button>
					&nbsp; &nbsp;
					<button type="button" class="btn btn-primary"
						onclick="validatestep3(true);">ออนไลน์</button>
				</div>


			</div>
			<div class="panel-footer" align="center">
				<button type="button" class="btn btn-default"
					onclick="validatestep3_back();">ย้อนกลับ</button>
			</div>
		</div>



	</div>
</body>
</html>